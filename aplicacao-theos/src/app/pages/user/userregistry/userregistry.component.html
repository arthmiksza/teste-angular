<div class="container mt-3 mb-3">
    <form (submit)="onSubmit()" [formGroup]="userForm">
        <div class="row">
            <div class="form-group col-xs-12 col-md-3" [ngClass]="{ 'isinvalid': submitted && control.tx_nome.errors }">
                <label for="tx_nome">Nome*</label>
                <input type="text" class="form-control" formControlName="tx_nome" id="tx_nome" placeholder="Digite seu nome">
                <div *ngIf="submitted && control.tx_nome.errors" class="invalidfeedback">
                  <div *ngIf="control.tx_nome.errors.required">O campo nome é obrigatório.</div>
                </div>
            </div>
            <div class="form-group col-xs-12 col-md-5" [ngClass]="{ 'isinvalid': submitted && control.tx_sobrenome.errors }">
                <label for="tx_sobrenome">Sobrenome*</label>
                <input type="text" class="form-control" formControlName="tx_sobrenome" id="tx_sobrenome" placeholder="Digite seu sobrenome">
                <div *ngIf="submitted && control.tx_sobrenome.errors" class="invalidfeedback">
                  <div *ngIf="control.tx_sobrenome.errors.required">O campo sobrenome é obrigatório.</div>
                </div>
            </div>
            <div class="form-group col-xs-12 col-md-4">
                <label for="tx_sexo">Sexo</label>
                <select class="form-control" id="tx_sexo" formControlName="tx_sexo">
                    <option *ngFor="let s of sexOpt" value="{{s}}">{{s}}</option>
                </select>
            </div>
            <div class="form-group col-xs-12 col-md-5" [ngClass]="{ 'isinvalid': submitted && control.tx_email.errors }">
                <label for="tx_email">Email*</label>
                <input type="text" class="form-control" formControlName="tx_email" id="tx_email" placeholder="Digite seu email">
                <div *ngIf="submitted && control.tx_email.errors" class="invalidfeedback">
                  <div *ngIf="control.tx_email.errors.required">O campo e-mail é obrigatório.</div>
                  <div *ngIf="control.tx_email.errors.email">Digite um e-mail válido.</div>
                </div>
            </div>
            <div class="form-group col-xs-12 col-md-3">
                <label for="tx_estado">Estado</label>
                <select class="form-control" id="tx_estado" formControlName="tx_estado">
                    <option *ngFor="let s of stateOpt" value="{{s}}">{{s}}</option>
                </select>
            </div>
            <div class="form-group col-xs-12 col-md-4">
                <label for="tx_cidade">Cidade</label>
                <select class="form-control" id="tx_cidade" formControlName="tx_cidade">
                    <option *ngFor="let s of cities" value="{{s}}">{{s}}</option>
                </select>
            </div>
            <div class="form-group col-xs-12 col-md-3" [ngClass]="{ 'isinvalid': submitted && control.dt_cadastro.errors }">
                <label for="dt_cadastro">Data do Cadastro*</label>
                <input type="text" mask="00/00/0000" class="form-control" formControlName="dt_cadastro" maxlength="10" id="dt_cadastro">
                <div *ngIf="submitted && control.dt_cadastro.errors" class="invalidfeedback">
                    <div *ngIf="control.dt_cadastro.errors.required">O campo data é obrigatório.</div>
                    <div *ngIf="control.dt_cadastro.errors.maxlength || control.dt_cadastro.errors.minlength">Insira uma data válida.</div>
                </div>
            </div>
            <div class="form-group col-xs-12 col-md-5" [ngClass]="{ 'isinvalid': submitted && control.tx_formacao.errors }">
                <label for="tx_formacao">Formação*</label>
                <input type="text" class="form-control" formControlName="tx_formacao" id="tx_formacao" placeholder="Digite sua formação">
                <div *ngIf="submitted && control.tx_formacao.errors" class="invalidfeedback">
                  <div *ngIf="control.tx_formacao.errors.required">O campo formação é obrigatório.</div>
                </div>
            </div>
            <div class="form-group col-xs-12 col-md-4" [ngClass]="{ 'isinvalid': submitted && control.tx_profissao.errors }">
                <label for="tx_profissao">Profissão*</label>
                <select class="form-control" id="tx_profissao" formControlName="tx_profissao">
                    <option *ngFor="let s of professionOpt" value="{{s}}">{{s}}</option>
                </select>
                <div *ngIf="submitted && control.tx_profissao.errors" class="invalidfeedback">
                  <div *ngIf="control.tx_profissao.errors.required">O campo profissão é obrigatório.</div>
                </div>
            </div>
        </div>
        <div class="container">
            <div class="row justify-content-end">
                <button class="btn btn-primary" (click)="setViewOnly(false)" *ngIf="viewOnly">Editar</button>
                <button type="button" class="btn btn-warning ml-3" (click)="searchUserModal()">Buscar</button>
                <button type="submit" class="btn btn-success ml-3" [disabled]="viewOnly">Salvar</button>
            </div>
        </div>
    </form>
</div>


<div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="modalSearch" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content" *ngIf="users?.length == 0">
            <div class="modal-header">
                <h5 class="modal-title" id="modalSearch">Busque usuários!</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Fechar">
                <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group col-xs-12">
                    <label for="tx_buscanome">Nome</label>
                    <input type="text" class="form-control" [(ngModel)]="nameSearch" id="tx_buscanome" placeholder="Busque por nome completo">
                </div>
                <button type="button" class="btn btn-primary" (click)="searchUser(1)">Buscar!</button>
                <hr>
                <div class="form-group col-xs-12">
                    <label for="tx_buscaprofissao">Profissão</label>
                    <select class="form-control" id="tx_profissao" [(ngModel)]="professionSearch">
                        <option *ngFor="let s of professionOpt" value="{{s}}">{{s}}</option>
                    </select>
                </div>
                <button type="button" class="btn btn-primary" (click)="searchUser(2)">Buscar!</button>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Fechar</button>
            </div>
        </div>
        <div class="modal-content" *ngIf="users?.length > 0" >
            <div class="modal-header">
                <h5 class="modal-title" id="modalSearch">Clique no card para selecionar um usuário!</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Fechar">
                <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="col-sm-12 mb-3" *ngFor="let u of users">
                    <app-carduser [data]="u" [showActions]="false" (onClickCard)="searchUserModalClose()"></app-carduser>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" (click)="backToSearch()">Voltar a busca</button>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Fechar</button>
            </div>
        </div>
    </div>
</div>
<app-loading *ngIf="loading"></app-loading>